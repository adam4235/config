#!/bin/bash
disk_loc=`cat ${HOME}/bin/disk_loc.txt`

while ! [ -e "${disk_loc}" ]
do
    echo "Waiting for disk..."
    sleep 1
done

LOCAL_BACKUP=${HOME}/backup
BACKUP=${disk_loc}/backup
FILENAME=archive.tar

echo "Creating archive..."
tar cvf "$LOCAL_BACKUP/$FILENAME" --same-owner --preserve-permissions ${HOME}/archive > $BACKUP/archive.log

echo "Copying archive to disk"
cp "$LOCAL_BACKUP/$FILENAME" "$BACKUP/$FILENAME"  #make a backup of the backup so that the next time we can safely remove the current file.

